{% comment %}
The sidenav is not loaded by default on the main pages. To include this navigation you can either use the
_layouts/page.html layout template, or you can add "sidenav: true" in the front-matter of your pages
{% endcomment %}


{% if page.type == 'create' %}

{% endif %}
{% if page.type == 'manage' %}
{% assign links = site.data.sidenav.manage %}
{% endif %}
{% if page.type == 'training' %}
{% assign links = site.data.sidenav.training %}
{% endif %}
<aside class="usa-layout-docs-sidenav desktop:grid-col-3 padding-bottom-4">
    <nav>
        <ul class="usa-sidenav">

            {% for link in links %}
            {% assign href = link.url %}
            {% assign current = false %}
            {% if href == page.url or href == page.permalink or currentGrandchild == 'true' %}
            {% assign current = true %}
            {% endif %}
            <li class="usa-sidenav__item">
                <a href="{% if link.external %}{{ href }}{% else %} {{ href | prepend: site.baseurl }} {% endif %}" {% if current %} class="usa-current" {% endif %}>
                    {{ link.name }}
                </a>
                {% if link.children %}
                <ul class="usa-sidenav__sublist">
                    {% for children in link.children %}
                    {% assign currentChild = false %}
                    {% if page.url == children.url or page.permalink == children.url %}
                    {% assign currentChild = true %}
                    {% endif %}
                    <li class="usa-sidenav__item">
                        <a href="{% if children.external %}{{ children.url }}{% else %} {{ children.url | prepend: site.baseurl }} {% endif %}" {% if currentChild %} class="usa-current" {% endif %}>
                            {{ children.name }}
                        </a>
                        {% if children.grandchildren %}
                         <ul class="usa-sidenav__sublist">
                          {% for grandchildren in children.grandchildren %}
                             {% assign currentGrandchild = false %}
                             {% if page.url == grandchildren.url or page.permalink == grandchildren.url %}
                             {% assign currentGrandchild = true %}
                             {% endif %}
                           <li class="usa-sidenav__item">
                             <a href="{% if grandchildren.external %}{{ grandchildren.url }}{% else %} {{ grandchildren.url | prepend: site.baseurl }} {% endif %}" {% if currentGrandchild %} class="usa-current" {% endif %}>
                               {{ grandchildren.name }}
                             </a>
                           </li>
                           {% endfor %}
                         </ul>
                        {% endif %}
                    </li>
                    {% endfor %}
                </ul>
                {% endif %}
            </li>
            {% endfor %}
        </ul>
    </nav>
</aside>
