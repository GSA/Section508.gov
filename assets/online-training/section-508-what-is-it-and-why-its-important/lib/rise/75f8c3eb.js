"use strict";(self.wpRiseJsonp=self.wpRiseJsonp||[]).push([["recorder"],{6662:(t,e,n)=>{n.r(e),n.d(e,{startRecording:()=>Nt});var o=n(80041),r=n(188),s=n(97621),i=n(8658),a=n(91066),c=n(67729),u=n(57692),l=n(94582),d=n(89521);const p=new WeakMap;function f(t){return p.has(t)}function h(t){return p.get(t)}function m(t,e){const n=t.tagName,o=t.value;if((0,d.Ie)(t,e)){const e=t.type;if("INPUT"===n&&("button"===e||"submit"===e||"reset"===e))return o;if(!o||"OPTION"===n)return;return d.o}return"OPTION"===n||"SELECT"===n?t.value:"INPUT"===n||"TEXTAREA"===n?o:void 0}const y=/url\((?:(')([^']*)'|(")([^"]*)"|([^)]*))\)/gm,g=/^[A-Za-z]+:|^\/\//,v=/^data:.*,/i;function w(t,e){return t.replace(y,((t,n,o,r,s,i)=>{const a=o||s||i;if(!e||!a||g.test(a)||v.test(a))return t;const c=n||r||"";return`url(${c}${function(t,e){try{return(0,l.c$)(t,e).href}catch(e){return t}}(a,e)}${c})`}))}const S=/[^a-z1-6-_]/;function E(t){const e=t.toLowerCase().trim();return S.test(e)?"div":e}function N(t,e){return`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='${t}' height='${e}' style='background-color:silver'%3E%3C/svg%3E`}const T={FullSnapshot:2,IncrementalSnapshot:3,Meta:4,Focus:6,ViewEnd:7,VisualViewport:8,FrustrationRecord:9},b={Document:0,DocumentType:1,Element:2,Text:3,CDATA:4,DocumentFragment:11},R={Mutation:0,MouseMove:1,MouseInteraction:2,Scroll:3,ViewportResize:4,Input:5,TouchMove:6,MediaInteraction:7,StyleSheetRule:8},x={MouseUp:0,MouseDown:1,Click:2,ContextMenu:3,DblClick:4,Focus:5,Blur:6,TouchStart:7,TouchEnd:9},I={Play:0,Pause:1};function M(t){if(void 0!==t&&0!==t.length)return t.map((t=>{const e=t.cssRules||t.rules;return{cssRules:Array.from(e,(t=>t.cssText)),disabled:t.disabled||void 0,media:t.media.length>0?Array.from(t.media):void 0}}))}var C=n(40549);function L(t,e,n,o){if(e===d.$m.HIDDEN)return null;const r=t.getAttribute(n);if(e===d.$m.MASK&&n!==d.NT&&!d.yF.includes(n)&&n!==o.actionNameAttribute){const e=t.tagName;switch(n){case"title":case"alt":case"placeholder":return d.o}if("IMG"===e&&("src"===n||"srcset"===n)){const e=t;if(e.naturalWidth>0)return N(e.naturalWidth,e.naturalHeight);const{width:n,height:o}=t.getBoundingClientRect();return n>0||o>0?N(n,o):d.eT}if("SOURCE"===e&&("src"===n||"srcset"===n))return d.eT;if("A"===e&&"href"===n)return d.o;if(r&&n.startsWith("data-"))return d.o;if("IFRAME"===e&&"srcdoc"===n)return d.o}return r&&"string"==typeof r&&(0,d.YR)(r)?(0,d.jK)(r):r}function D(t){if(!t)return null;let e;try{e=t.rules||t.cssRules}catch(t){}if(!e)return null;return w(Array.from(e,(0,C.nr)()?_:O).join(""),t.href)}function _(t){if(function(t){return"selectorText"in t}(t)&&t.selectorText.includes(":")){const e=/(\[[\w-]+[^\\])(:[^\]]+\])/g;return t.cssText.replace(e,"$1\\$2")}return O(t)}function O(t){return function(t){return"styleSheet"in t}(t)&&D(t.styleSheet)||t.cssText}function P(t,e){const n=function(t,e){switch(t.nodeType){case t.DOCUMENT_NODE:return function(t,e){return{type:b.Document,childNodes:$(t,e),adoptedStyleSheets:M(t.adoptedStyleSheets)}}(t,e);case t.DOCUMENT_FRAGMENT_NODE:return function(t,e){const n=(0,d.p_)(t);n&&e.serializationContext.shadowRootsController.addShadowRoot(t);return{type:b.DocumentFragment,childNodes:$(t,e),isShadowRoot:n,adoptedStyleSheets:n?M(t.adoptedStyleSheets):void 0}}(t,e);case t.DOCUMENT_TYPE_NODE:return n=t,{type:b.DocumentType,name:n.name,publicId:n.publicId,systemId:n.systemId};case t.ELEMENT_NODE:return function(t,e){const n=E(t.tagName),o=(s=t,"svg"===s.tagName||s instanceof SVGElement||void 0),r=(0,d.jR)((0,d.dT)(t),e.parentNodePrivacyLevel);var s;if(r===d.$m.HIDDEN){const{width:e,height:r}=t.getBoundingClientRect();return{type:b.Element,tagName:n,attributes:{rr_width:`${e}px`,rr_height:`${r}px`,[d.NT]:d.Wd},childNodes:[],isSVG:o}}if(r===d.$m.IGNORE)return;const i=function(t,e,n){if(e===d.$m.HIDDEN)return{};const o={},r=E(t.tagName),s=t.ownerDocument;for(let r=0;r<t.attributes.length;r+=1){const s=t.attributes.item(r).name,i=L(t,e,s,n.configuration);null!==i&&(o[s]=i)}if(t.value&&("textarea"===r||"select"===r||"option"===r||"input"===r)){const n=m(t,e);void 0!==n&&(o.value=n)}if("option"===r&&e===d.$m.ALLOW){const e=t;e.selected&&(o.selected=e.selected)}if("link"===r){const e=Array.from(s.styleSheets).find((e=>e.href===t.href)),n=D(e);n&&e&&(o._cssText=n)}if("style"===r&&t.sheet){const e=D(t.sheet);e&&(o._cssText=e)}const i=t;if("input"!==r||"radio"!==i.type&&"checkbox"!==i.type||(e===d.$m.ALLOW?o.checked=!!i.checked:(0,d.Ie)(i,e)&&delete o.checked),"audio"===r||"video"===r){const e=t;o.rr_mediaState=e.paused?"paused":"played"}let a,c;const u=n.serializationContext;switch(u.status){case 0:a=Math.round(t.scrollTop),c=Math.round(t.scrollLeft),(a||c)&&u.elementsScrollPositions.set(t,{scrollTop:a,scrollLeft:c});break;case 1:u.elementsScrollPositions.has(t)&&({scrollTop:a,scrollLeft:c}=u.elementsScrollPositions.get(t))}return c&&(o.rr_scrollLeft=c),a&&(o.rr_scrollTop=a),o}(t,r,e);let a=[];if((0,d.wR)(t)&&"style"!==n){let o;o=e.parentNodePrivacyLevel===r&&e.ignoreWhiteSpace===("head"===n)?e:{...e,parentNodePrivacyLevel:r,ignoreWhiteSpace:"head"===n},a=$(t,o)}return{type:b.Element,tagName:n,attributes:i,childNodes:a,isSVG:o}}(t,e);case t.TEXT_NODE:return function(t,e){const n=(0,d.rf)(t,e.ignoreWhiteSpace||!1,e.parentNodePrivacyLevel);if(void 0===n)return;return{type:b.Text,textContent:n}}(t,e);case t.CDATA_SECTION_NODE:return{type:b.CDATA,textContent:""}}var n}(t,e);if(!n)return null;const o=h(t)||V++,r=n;return r.id=o,function(t,e){p.set(t,e)}(t,o),e.serializedNodeIds&&e.serializedNodeIds.add(o),r}let V=1;function $(t,e){const n=[];return(0,d.wI)(t,(t=>{const o=P(t,e);o&&n.push(o)})),n}function A(t,e,n){return P(t,{serializationContext:n,parentNodePrivacyLevel:e.defaultPrivacyLevel,configuration:e})}function k(t){return Boolean(t.changedTouches)}function H(t){return!0===t.composed&&(0,d.XS)(t.target)?t.composedPath()[0]:t.target}const F=(t,e)=>{const n=window.visualViewport,o={layoutViewportX:t,layoutViewportY:e,visualViewportX:t,visualViewportY:e};return n?(!function(t){return Math.abs(t.pageTop-t.offsetTop-window.scrollY)>25||Math.abs(t.pageLeft-t.offsetLeft-window.scrollX)>25}(n)?(o.visualViewportX=Math.round(t-n.offsetLeft),o.visualViewportY=Math.round(e-n.offsetTop)):(o.layoutViewportX=Math.round(t+n.offsetLeft),o.layoutViewportY=Math.round(e+n.offsetTop)),o):o},z=t=>({scale:t.scale,offsetLeft:t.offsetLeft,offsetTop:t.offsetTop,pageLeft:t.pageLeft,pageTop:t.pageTop,height:t.height,width:t.width});var B=n(35430);function W(t,e){return{data:{source:t,...e},type:T.IncrementalSnapshot,timestamp:(0,B.nx)()}}const G=50;function J(t,e){const{throttled:n,cancel:o}=(0,c.n)((t=>{const n=H(t);if(f(n)){const o=U(t);if(!o)return;const r={id:h(n),timeOffset:0,x:o.x,y:o.y};e(W(k(t)?R.TouchMove:R.MouseMove,{positions:[r]}))}}),G,{trailing:!1}),{stop:r}=(0,u.l)(t,document,["mousemove","touchmove"],n,{capture:!0,passive:!0});return{stop:()=>{r(),o()}}}function U(t){let{clientX:e,clientY:n}=k(t)?t.changedTouches[0]:t;if(window.visualViewport){const{visualViewportX:t,visualViewportY:o}=F(e,n);e=t,n=o}if(Number.isFinite(e)&&Number.isFinite(n))return{x:e,y:n};t.isTrusted&&(0,o.A2)("mouse/touch event without x/y")}const Y={pointerup:x.MouseUp,mousedown:x.MouseDown,click:x.Click,contextmenu:x.ContextMenu,dblclick:x.DblClick,focus:x.Focus,blur:x.Blur,touchstart:x.TouchStart,touchend:x.TouchEnd};function X(t,e,n){return(0,u.l)(t,document,Object.keys(Y),(o=>{const r=H(o);if((0,d.PJ)(r,t.defaultPrivacyLevel)===d.$m.HIDDEN||!f(r))return;const s=h(r),i=Y[o.type];let a;if(i!==x.Blur&&i!==x.Focus){const t=U(o);if(!t)return;a={id:s,type:i,x:t.x,y:t.y}}else a={id:s,type:i};const c={id:n.getIdForEvent(o),...W(R.MouseInteraction,a)};e(c)}),{capture:!0,passive:!0})}const j=100;function K(t,e,n,o=document){const{throttled:r,cancel:s}=(0,c.n)((o=>{const r=H(o);if(!r||(0,d.PJ)(r,t.defaultPrivacyLevel)===d.$m.HIDDEN||!f(r))return;const s=h(r),i=r===document?{scrollTop:(0,d.zL)(),scrollLeft:(0,d.Gn)()}:{scrollTop:Math.round(r.scrollTop),scrollLeft:Math.round(r.scrollLeft)};n.set(r,i),e(W(R.Scroll,{id:s,x:i.scrollLeft,y:i.scrollTop}))}),j),{stop:i}=(0,u.q)(t,o,"scroll",r,{capture:!0,passive:!0});return{stop:()=>{i(),s()}}}const q=200;function Z(t,e){const n=(0,d.g1)(t).subscribe((t=>{e(W(R.ViewportResize,t))}));return{stop:()=>{n.unsubscribe()}}}function Q(t,e){const n=window.visualViewport;if(!n)return{stop:c.l};const{throttled:o,cancel:r}=(0,c.n)((()=>{e({data:z(n),type:T.VisualViewport,timestamp:(0,B.nx)()})}),q,{trailing:!1}),{stop:s}=(0,u.l)(t,n,["resize","scroll"],o,{capture:!0,passive:!0});return{stop:()=>{s(),r()}}}function tt(t,e){return(0,u.l)(t,document,["play","pause"],(n=>{const o=H(n);o&&(0,d.PJ)(o,t.defaultPrivacyLevel)!==d.$m.HIDDEN&&f(o)&&e(W(R.MediaInteraction,{id:h(o),type:"play"===n.type?I.Play:I.Pause}))}),{capture:!0,passive:!0})}var et=n(3352);function nt(t){function e(t,e){t&&f(t.ownerNode)&&e(h(t.ownerNode))}const n=[(0,et.H)(CSSStyleSheet.prototype,"insertRule",(({target:n,parameters:[o,r]})=>{e(n,(e=>t(W(R.StyleSheetRule,{id:e,adds:[{rule:o,index:r}]}))))})),(0,et.H)(CSSStyleSheet.prototype,"deleteRule",(({target:n,parameters:[o]})=>{e(n,(e=>t(W(R.StyleSheetRule,{id:e,removes:[{index:o}]}))))}))];function o(o){n.push((0,et.H)(o.prototype,"insertRule",(({target:n,parameters:[o,r]})=>{e(n.parentStyleSheet,(e=>{const s=ot(n);s&&(s.push(r||0),t(W(R.StyleSheetRule,{id:e,adds:[{rule:o,index:s}]})))}))})),(0,et.H)(o.prototype,"deleteRule",(({target:n,parameters:[o]})=>{e(n.parentStyleSheet,(e=>{const r=ot(n);r&&(r.push(o),t(W(R.StyleSheetRule,{id:e,removes:[{index:r}]})))}))})))}return"undefined"!=typeof CSSGroupingRule?o(CSSGroupingRule):(o(CSSMediaRule),o(CSSSupportsRule)),{stop:()=>{n.forEach((t=>t.stop()))}}}function ot(t){const e=[];let n=t;for(;n.parentRule;){const t=Array.from(n.parentRule.cssRules).indexOf(n);e.unshift(t),n=n.parentRule}if(!n.parentStyleSheet)return;const o=Array.from(n.parentStyleSheet.cssRules).indexOf(n);return e.unshift(o),e}function rt(t,e){return(0,u.l)(t,window,["focus","blur"],(()=>{e({data:{has_focus:document.hasFocus()},type:T.Focus,timestamp:(0,B.nx)()})}))}function st(t,e,n){const o=t.subscribe(12,(t=>{var o,r;"action"===t.rawRumEvent.type&&"click"===t.rawRumEvent.action.type&&(null===(r=null===(o=t.rawRumEvent.action.frustration)||void 0===o?void 0:o.type)||void 0===r?void 0:r.length)&&"events"in t.domainContext&&t.domainContext.events&&t.domainContext.events.length&&e({timestamp:t.rawRumEvent.date,type:T.FrustrationRecord,data:{frustrationTypes:t.rawRumEvent.action.frustration.type,recordIds:t.domainContext.events.map((t=>n.getIdForEvent(t)))}})}));return{stop:()=>{o.unsubscribe()}}}function it(t,e){const n=t.subscribe(5,(()=>{e({timestamp:(0,B.nx)(),type:T.ViewEnd})}));return{stop:()=>{n.unsubscribe()}}}function at(t,e,n=document){const o=t.defaultPrivacyLevel,r=new WeakMap,s=n!==document,{stop:i}=(0,u.l)(t,n,s?["change"]:["input","change"],(t=>{const e=H(t);(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement)&&l(e)}),{capture:!0,passive:!0});let a;if(s)a=c.l;else{const t=[(0,et.t)(HTMLInputElement.prototype,"value",l),(0,et.t)(HTMLInputElement.prototype,"checked",l),(0,et.t)(HTMLSelectElement.prototype,"value",l),(0,et.t)(HTMLTextAreaElement.prototype,"value",l),(0,et.t)(HTMLSelectElement.prototype,"selectedIndex",l)];a=()=>{t.forEach((t=>t.stop()))}}return{stop:()=>{a(),i()}};function l(t){const e=(0,d.PJ)(t,o);if(e===d.$m.HIDDEN)return;const n=t.type;let r;if("radio"===n||"checkbox"===n){if((0,d.Ie)(t,e))return;r={isChecked:t.checked}}else{const n=m(t,e);if(void 0===n)return;r={text:n}}p(t,r);const s=t.name;"radio"===n&&s&&t.checked&&document.querySelectorAll(`input[type="radio"][name="${CSS.escape(s)}"]`).forEach((e=>{e!==t&&p(e,{isChecked:!1})}))}function p(t,n){if(!f(t))return;const o=r.get(t);o&&o.text===n.text&&o.isChecked===n.isChecked||(r.set(t,n),e(W(R.Input,{id:h(t),...n})))}}var ct=n(36040),ut=n(51490);const lt=100,dt=16;function pt(t,e,n,o){const r=(0,d.W3)();if(!r)return{stop:c.l,flush:c.l};const s=function(t){let e=c.l,n=[];function o(){e(),t(n),n=[]}const{throttled:r,cancel:s}=(0,c.n)(o,dt,{leading:!1});return{addMutations:t=>{0===n.length&&(e=(0,ut.BB)(r,{timeout:lt})),n.push(...t)},flush:o,stop:()=>{e(),s()}}}((o=>{!function(t,e,n,o){const r=new Map;t.filter((t=>"childList"===t.type)).forEach((t=>{t.removedNodes.forEach((t=>{ft(t,o.removeShadowRoot)}))}));const s=t.filter((t=>t.target.isConnected&&function(t){let e=t;for(;e;){if(!f(e)&&!(0,d.p_)(e))return!1;e=(0,d.$4)(e)}return!0}(t.target)&&(0,d.PJ)(t.target,n.defaultPrivacyLevel,r)!==d.$m.HIDDEN)),{adds:i,removes:a,hasBeenSerialized:c}=function(t,e,n,o){const r=new Set,s=new Map;for(const e of t)e.addedNodes.forEach((t=>{r.add(t)})),e.removedNodes.forEach((t=>{r.has(t)||s.set(t,e.target),r.delete(t)}));const i=Array.from(r);a=i,a.sort(((t,e)=>{const n=t.compareDocumentPosition(e);return n&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:n&Node.DOCUMENT_POSITION_CONTAINS||n&Node.DOCUMENT_POSITION_FOLLOWING?1:n&Node.DOCUMENT_POSITION_PRECEDING?-1:0}));var a;const c=new Set,u=[];for(const t of i){if(p(t))continue;const r=(0,d.PJ)(t.parentNode,e.defaultPrivacyLevel,o);if(r===d.$m.HIDDEN||r===d.$m.IGNORE)continue;const s=P(t,{serializedNodeIds:c,parentNodePrivacyLevel:r,serializationContext:{status:2,shadowRootsController:n},configuration:e});if(!s)continue;const i=(0,d.$4)(t);u.push({nextId:m(t),parentId:h(i),node:s})}const l=[];return s.forEach(((t,e)=>{f(e)&&l.push({parentId:h(t),id:h(e)})})),{adds:u,removes:l,hasBeenSerialized:p};function p(t){return f(t)&&c.has(h(t))}function m(t){let e=t.nextSibling;for(;e;){if(f(e))return h(e);e=e.nextSibling}return null}}(s.filter((t=>"childList"===t.type)),n,o,r),u=function(t,e,n){var o;const r=[],s=new Set,i=t.filter((t=>!s.has(t.target)&&(s.add(t.target),!0)));for(const t of i){if(t.target.textContent===t.oldValue)continue;const s=(0,d.PJ)((0,d.$4)(t.target),e.defaultPrivacyLevel,n);s!==d.$m.HIDDEN&&s!==d.$m.IGNORE&&r.push({id:h(t.target),value:null!==(o=(0,d.rf)(t.target,!1,s))&&void 0!==o?o:null})}return r}(s.filter((t=>"characterData"===t.type&&!c(t.target))),n,r),l=function(t,e,n){const o=[],r=new Map,s=t.filter((t=>{const e=r.get(t.target);return(!e||!e.has(t.attributeName))&&(e?e.add(t.attributeName):r.set(t.target,new Set([t.attributeName])),!0)})),i=new Map;for(const t of s){if(t.target.getAttribute(t.attributeName)===t.oldValue)continue;const r=(0,d.PJ)(t.target,e.defaultPrivacyLevel,n),s=L(t.target,r,t.attributeName,e);let a;if("value"===t.attributeName){const e=m(t.target,r);if(void 0===e)continue;a=e}else a="string"==typeof s?s:null;let c=i.get(t.target);c||(c={id:h(t.target),attributes:{}},o.push(c),i.set(t.target,c)),c.attributes[t.attributeName]=a}return o}(s.filter((t=>"attributes"===t.type&&!c(t.target))),n,r);if(!(u.length||l.length||a.length||i.length))return;e(W(R.Mutation,{adds:i,removes:a,texts:u,attributes:l}))}(o.concat(i.takeRecords()),t,e,n)})),i=new r((0,ct.dm)(s.addMutations));return i.observe(o,{attributeOldValue:!0,attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),{stop:()=>{i.disconnect(),s.stop()},flush:()=>{s.flush()}}}function ft(t,e){(0,d.XS)(t)&&e(t.shadowRoot),(0,d.wI)(t,(t=>ft(t,e)))}const ht=(t,e,n)=>{const o=new Map,r={addShadowRoot:s=>{if(o.has(s))return;const i=pt(e,t,r,s),a=at(t,e,s),c=K(t,e,n,s);o.set(s,{flush:()=>i.flush(),stop:()=>{i.stop(),a.stop(),c.stop()}})},removeShadowRoot:t=>{const e=o.get(t);e&&(e.stop(),o.delete(t))},stop:()=>{o.forEach((({stop:t})=>t()))},flush:()=>{o.forEach((({flush:t})=>t()))}};return r};function mt(t){const{emit:e,configuration:n,lifeCycle:o}=t;if(!e)throw new Error("emit function is required");const r=n=>{e(n),(0,i.b)("record",{record:n});const o=t.viewHistory.findView();a.$1(o.id)},s=function(){const t=new WeakMap;return{set(e,n){(e!==document||document.scrollingElement)&&t.set(e===document?document.scrollingElement:e,n)},get:e=>t.get(e),has:e=>t.has(e)}}(),c=ht(n,r,s),{stop:u}=function(t,e,n,o,r,s){const i=(n=(0,B.nx)(),r={status:0,elementsScrollPositions:t,shadowRootsController:e})=>{const{width:s,height:i}=(0,d.pB)(),a=[{data:{height:i,href:window.location.href,width:s},type:T.Meta,timestamp:n},{data:{has_focus:document.hasFocus()},type:T.Focus,timestamp:n},{data:{node:A(document,o,r),initialOffset:{left:(0,d.Gn)(),top:(0,d.zL)()}},type:T.FullSnapshot,timestamp:n}];return window.visualViewport&&a.push({data:z(window.visualViewport),type:T.VisualViewport,timestamp:n}),a};s(i());const{unsubscribe:a}=n.subscribe(2,(n=>{r(),s(i(n.startClocks.timeStamp,{shadowRootsController:e,status:1,elementsScrollPositions:t}))}));return{stop:a}}(s,c,o,n,l,(t=>t.forEach((t=>r(t)))));function l(){c.flush(),f.flush()}const p=function(){const t=new WeakMap;let e=1;return{getIdForEvent:n=>(t.has(n)||t.set(n,e++),t.get(n))}}(),f=pt(r,n,c,document),h=[f,J(n,r),X(n,r,p),K(n,r,s,document),Z(n,r),at(n,r),tt(n,r),nt(r),rt(n,r),Q(n,r),st(o,r,p),it(o,(t=>{l(),r(t)}))];return{stop:()=>{c.stop(),h.forEach((t=>t.stop())),u()},flushMutations:l,shadowRootsController:c}}var yt=n(75460),gt=n(86743);function vt({context:t,creationReason:e,encoder:n}){let o=0;const r=t.view.id,s={start:1/0,end:-1/0,creation_reason:e,records_count:0,has_full_snapshot:!1,index_in_view:a.K_(r),source:"browser",...t};return a.H5(r),{addRecord:function(t,e){s.start=Math.min(s.start,t.timestamp),s.end=Math.max(s.end,t.timestamp),s.records_count+=1,s.has_full_snapshot||(s.has_full_snapshot=t.type===T.FullSnapshot);const r=n.isEmpty?'{"records":[':",";n.write(r+JSON.stringify(t),(t=>{o+=t,e(o)}))},flush:function(t){if(n.isEmpty)throw new Error("Empty segment flushed");n.write(`],${JSON.stringify(s).slice(1)}\n`),n.finish((e=>{a.L7(s.view.id,e.rawBytesCount),t(s,e)}))}}}const wt=5*B.OY;let St=6e4;function Et(t,e,n,o,r,s){return function(t,e,n,o){let r={status:0,nextSegmentCreationReason:"init"};const{unsubscribe:s}=t.subscribe(2,(()=>{a("view_change")})),{unsubscribe:i}=t.subscribe(11,(t=>{a(t.reason)}));function a(t){1===r.status&&(r.segment.flush(((e,o)=>{const r=function(t,e,n){const o=new FormData;o.append("segment",new Blob([t],{type:"application/octet-stream"}),`${e.session.id}-${e.start}`);const r={raw_segment_size:n,compressed_segment_size:t.byteLength,...e},s=JSON.stringify(r);return o.append("event",new Blob([s],{type:"application/json"})),{data:o,bytesCount:t.byteLength}}(o.output,e,o.rawBytesCount);(0,yt.Kp)(t)?n.sendOnExit(r):n.send(r)})),(0,gt.DJ)(r.expirationTimeoutId)),r="stop"!==t?{status:0,nextSegmentCreationReason:t}:{status:2}}return{addRecord:t=>{if(2!==r.status){if(0===r.status){const t=e();if(!t)return;r={status:1,segment:vt({encoder:o,context:t,creationReason:r.nextSegmentCreationReason}),expirationTimeoutId:(0,gt.wg)((()=>{a("segment_duration_limit")}),wt)}}r.segment.addRecord(t,(t=>{t>St&&a("segment_bytes_limit")}))}},stop:()=>{a("stop"),s(),i()}}}(t,(()=>function(t,e,n){const o=e.findTrackedSession(),r=n.findView();if(!o||!r)return;return{application:{id:t},session:{id:o.id},view:{id:r.id}}}(e.applicationId,n,o)),r,s)}function Nt(t,e,n,i,a,c){const u=[],l=c||(0,r.sA)(e.sessionReplayEndpointBuilder,St,(e=>{t.notify(14,{error:e}),(0,o.A2)("Error reported to customer",{"error.message":e.message})}));let d;if((0,s.d0)())({addRecord:d}=function(t){const e=(0,s.Y9)();return{addRecord:n=>{const o=t.findView();e.send("record",n,o.id)}}}(i));else{const o=Et(t,e,n,i,l,a);d=o.addRecord,u.push(o.stop)}const{stop:p}=mt({emit:d,configuration:e,lifeCycle:t,viewHistory:i});return u.push(p),{stop:()=>{u.forEach((t=>t()))}}}}}]);